<link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">

{% extends "base_logged_in.html" %}

{% block content %}
    <script>
        var take_youre_rating =false;
        {% set holes_multi=1 %}
    {% if  course.holes[0] < 9 %}
        alert("Den här banan har för få hål för att du ska kunna tillgodose en rating.")
    {% elif 9 <= course.holes[0] < 18 %}
        var take_youre_rating = confirm("Du måste gå två rundor för att kunna tillgodose dig rating, vill du göra det?");
        if (take_youre_rating==true){
            {% set holes_multi=2 %}
            {{ holes_multi|to_console }}
            alert("du klickade ja");}
        else{
            alert("du klickade nej");}
    {% endif %}

    </script>
    <section class="scorecard">
            <!-- Slider main container -->
        <div class="swiper-container">
            <!-- Additional required wrapper -->
            <div class="swiper-wrapper">
                <!-- Slides -->
                {% set j=0 %}
                {% for i in range(course.holes[0] * holes_multi + 1) %}
                    {% if i < course.holes[0] * holes_multi %}
                        {% if (i - j) >= course.holes[0] %}
                            {% set j = course.holes[0] %}
                        {% endif %}
                        <div class="swiper-slide">
                        <section class="scorecard">
                            <!--Hole Info-->
                            <div class="container h10 w-100 center-content-h shadow" style="background-color: aqua">
                                <div class="container h100 center-content" style="background-color: #23c2ff">
                                    <div class="small-text font-weight-bold"> Hole {{ i + 1 }} ({{  i + 1 - j }})</div>
                                </div>
                                <div class="container h100 center-content" style="background-color: #eeeeee">
                                    <div class="small-text font-weight-bold"> Par {{course.holes[i + 1 - j]['Par'] }}</div>
                                </div>
                                <div class="container h100 center-content" style="background-color: purple">
                                    <div class="small-text font-weight-bold"> {{ course.holes[i + 1 - j]['length'] }}m </div>
                                </div>
                            </div>

                            <!--Net & Throws-->
                            <div class="container h05 center-content" style="margin-top: 5px">
                                <div class="col-12 center-content-left">
                                    <div class="col-4 center-content">
                                        <div class="tiny-text center-content">
                                            Expected Throws
                                        </div>
                                    </div>
                                    <div class="col-4 center-content">
                                        <div class="tiny-text center-content">
                                            Actual Throws
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!--Player information-->
                            <div class="container h85 top-align no-padding" style="background-color: aquamarine">
                                {% for player in players %}
                                    <div class="col-12 h20 center-content-h">
                                        <div class="col-4 center-content">
                                            <div class="small-text center-content">
                                                {{ player.full_name }}
                                            </div>
                                        </div>
                                        <div class="col-4 center-content">
                                            <div class="small-text center-content">
                                                {{ course.holes[i + 1 - j]['Par']|int + player.hcp[i - j]["strokes"] }}
                                            </div>
                                        </div>
                                        <div class="col-4 center-content">
                                            <input class="form-control form-control-sm throws-input" type="number" placeholder="" style="text-align: center " id="{{ player.user_name }}_{{ i + 1 }}_{{ course.holes[i + 1 - j]['Par']}}_{{player.hcp[i - j]['strokes'] }}">
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </section>
                    </div>
                    {% else %}
                         <div class="swiper-slide">
                        <section class="scorecard">
                            <table class="table table-striped table-sm">
                                <thead>
                                    <tr>
                                        <th scope="col">Player</th>
                                        {% for i in range(1, 10) %}
                                            <th scope="col">{{ i }}</th>
                                        {% endfor %}
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for player in players %}
                                        <tr>
                                            <td scope="row">{{ player.user_name }}</td>
                                            {% for i in range(1, 10) %}
                                                <td id="{{ player.user_name}}{{ i }}">0</td>
                                            {% endfor %}
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            {% if course.holes[0] > 9 %}
                                <table class="table table-striped table-sm">
                                    <thead>
                                        <tr>
                                            <th scope="col">Player</th>
                                            {% for i in range(course.holes[0] - 8, course.holes[0] + 1) %}
                                                <th scope="col">{{ i }}</th>
                                            {% endfor %}
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for player in players %}
                                            <tr>
                                                <td scope="row">{{ player.user_name }}</td>
                                                {% for i in range(course.holes[0] - 8, course.holes[0] + 1) %}
                                                    <td id="{{ player.user_name}}{{ i }}">0</td>
                                                {% endfor %}
                                            </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            {% endif %}
                            <div class="container w100 center-content-h">
                                <div class="col-4"></div>
                                <div class="col-4">
                                    <div class="tiny-text">Points</div>
                                </div>
                                <div class="col-4">
                                    <div class="tiny-text">Par</div>
                                </div>
                            </div>
                            <hr>
                            {% for player in players %}
                                <div class="container w100 center-content-h">
                                    <div class="col-4 center-content-v" style="text-align: left">
                                        <div class="tiny-text" style="padding-left: 10px">{{ player.user_name }}</div>
                                    </div>
                                    <div class="col-4 tiny-text" id="{{ player.user_name }}_points">0</div>
                                    <div class="col-4 tiny-text" id="{{ player.user_name }}_par">0</div>
                                </div>
                                <hr>
                            {% endfor %}
                            <div class="container w100 center-content">
                                <div class="container w70">
                                    <a class="btn btn-primary btn-m w-100 button-text" onclick="submit_scorecards()" style="margin-top: 30px" role="button">Submit Scorecards</a>
                                </div>
                            </div>
                        </section>
                    </div>


                    {% endif %}
                {% endfor %}

            </div>
            <!-- If we need pagination -->
            <div class="swiper-pagination"></div>

        </div>

    </section>



{% endblock %}

{% block javascript %}

    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script src="../static/js/scorecard_play.js"></script>
    <script>

        let player_summary = {};
        player_summary['Course'] = '{{ course._id }}'
        {% for player in players %}
            player_summary["{{ player.user_name }}"] = {
                {% for i in range(course.holes[0]) %}
                    "hole{{ i + 1 }}_points": 0,
                    "hole{{ i + 1 }}_par": 0,
                    "hole{{ i + 1 }}_throws": 0,
                {% endfor %}
            };
        {% endfor %}







    var elements=document.getElementsByClassName("throws-input");
    for (let i = 0; i < elements.length; i++ ){elements[i].addEventListener("input", update_result) }
    </script>
{% endblock %}